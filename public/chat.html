<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>REDTalk ‚Äì Chat</title>
<style>
*{box-sizing:border-box;}
body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu;background:#f5f5f5;height:100vh;display:flex;flex-direction:column;}
header{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-bottom:1px solid #e0e0e0;}
header button{background:none;border:none;font-size:20px;cursor:pointer;}
header .room-name{font-weight:600;font-size:16px;cursor:pointer;}
.chat{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;position:relative;}
.bubble{max-width:75%;padding:10px 14px;border-radius:16px;font-size:14px;line-height:1.4;word-wrap:break-word;position:relative;}
.me{align-self:flex-end;background:#e53935;color:#fff;border-bottom-right-radius:4px;}
.other{align-self:flex-start;background:#e0e0e0;color:#000;border-bottom-left-radius:4px;}
.bubble.unread{font-weight:bold;background:#ffebee;}
.bubble.read::after{content:'‚Ä¢';position:absolute;bottom:2px;right:4px;color:#4caf50;font-size:12px;}
.input-area{display:flex;gap:8px;padding:10px;background:#fff;border-top:1px solid #e0e0e0;}
.input-area input{flex:1;padding:12px;border-radius:20px;border:1px solid #ddd;outline:none;font-size:14px;}
.input-area button{background:#e53935;color:#fff;border:none;border-radius:50%;width:44px;height:44px;font-size:16px;cursor:pointer;}
</style>
</head>
<body>
<header>
  <button onclick="goBack()">‚Üê</button>
  <div class="room-name" id="roomName">Chat</div>
</header>

<div class="chat" id="chatBox">
  <div class="bubble other unread">Halo üëã</div>
  <div class="bubble me read">Hai</div>
</div>

<div class="input-area">
  <input id="messageInput" type="text" placeholder="Type a message" />
  <button onclick="sendMessage()">‚û§</button>
</div>

<script>
const params=new URLSearchParams(window.location.search);
const room=params.get("room")||"Chat";
document.getElementById("roomName").innerText=room;

function sendMessage(){
  const input=document.getElementById("messageInput");
  const text=input.value.trim();
  if(!text) return;
  const bubble=document.createElement("div");
  bubble.className="bubble me read";
  bubble.innerText=text;
  document.getElementById("chatBox").appendChild(bubble);
  input.value="";
  document.getElementById("chatBox").scrollTop=document.getElementById("chatBox").scrollHeight;
}

// Auto-clear chat 30 hari (mock)
if(!localStorage.getItem("REDTalkLastClear")){
  localStorage.setItem("REDTalkLastClear",Date.now());
}else{
  const lastClear=Number(localStorage.getItem("REDTalkLastClear"));
  const now=Date.now();
  if(now-lastClear>30*24*60*60*1000){ // 30 hari
    document.getElementById("chatBox").innerHTML="";
    localStorage.setItem("REDTalkLastClear",now);
  }
}

function goBack(){window.location.href="room.html";}
</script>
</body>
</html>
